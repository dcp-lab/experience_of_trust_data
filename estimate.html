<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>Expectation</title>
<link href="style.css" rel="stylesheet" type="text/css"/>
<script>
      function submitEstimate(event) {
        event.preventDefault();
        const input = document.getElementById("estimateInput");
        const value = parseFloat(input.value);
        if (isNaN(value) || value < 0 || value > 12) {
          alert("Please enter a valid number between 0 and 12.");
          return;
        }
        localStorage.setItem("Estimate", JSON.stringify({ averageExpected: value }));
        const task = localStorage.getItem("Condition");
        window.location.href = task === "TG" ? "trust_game.html" : "dictator_game.html";
      }
    </script>
</head>
<body>
<div class="content" style="max-width: 600px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; background-color: #f9f9f9;">
<h2>Expectation</h2>
<p><b>You have been assigned to a <u>Player B</u> role.</b></p>
<p>In each round, a new participant (Player A) will choose how much to send you from their initial endowment of 12 units.</p>
<p><b>Based on this, how much of Player A's 12 monetary units do you expect to receive on average per trial?</b></p>
<form onsubmit="submitEstimate(event)" style="display: flex; flex-direction: column; gap: 10px;">
<label>Your Estimate:</label>
<input id="estimateInput" max="12" min="0" placeholder="Enter your estimate between 0 and 12" required="" step="1" type="number"/>
<button type="submit">Submit</button><button id="exitButton" onclick="confirmExit()">Exit Experiment</button>
</form>
</div>


<script>
function confirmExit() {
    const confirmed = confirm("Are you sure you want to exit the experiment? Your data will be deleted.");
    if (confirmed) {
        localStorage.clear();
        sessionStorage.clear();
        document.cookie.split(";").forEach(function(c) {
            document.cookie = c.trim().split("=")[0] + "=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/";
        });
        window.location.href = "index.html";
    }
}
</script>

<script>// Injected storage for estimate.html
try {
localStorage.setItem("Estimate", JSON.stringify({ averageExpected: estimateValue }));
} catch(e) { console.warn(e); }
</script>
</body>
</html>
